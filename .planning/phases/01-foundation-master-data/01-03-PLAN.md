---
phase: 01-foundation-master-data
plan: 03
title: "Dashboard UI, Master Data Pages, Seed Data & Audit Viewer"
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/app/(dashboard)/layout.tsx
  - src/app/(dashboard)/page.tsx
  - src/app/(dashboard)/brands/page.tsx
  - src/app/(dashboard)/brands/columns.tsx
  - src/app/(dashboard)/skus/page.tsx
  - src/app/(dashboard)/skus/columns.tsx
  - src/app/(dashboard)/retailers/page.tsx
  - src/app/(dashboard)/retailers/columns.tsx
  - src/app/(dashboard)/audit/page.tsx
  - src/components/dashboard/app-sidebar.tsx
  - src/components/dashboard/user-nav.tsx
  - src/components/dashboard/data-table.tsx
  - src/components/dashboard/brand-form-dialog.tsx
  - src/components/dashboard/sku-form-dialog.tsx
  - src/components/dashboard/retailer-form-dialog.tsx
  - src/components/dashboard/stat-card.tsx
  - src/server/db/seed.ts
autonomous: true

must_haves:
  truths:
    - "Dashboard displays a sidebar with navigation links: Dashboard, Brands, SKUs, Retailers, Audit Log"
    - "Brands page shows a table of all 5 brands with name, description, lead time, SKU count, and active status"
    - "SKUs page shows a filterable table of all ~160 SKUs with brand name, SKU code, name, category, and status"
    - "Retailers page shows a table of all ~12 retailers with name, code, parent group, channel, and status"
    - "Audit Log page shows recent changes with table name, action, timestamp, and changed data"
    - "Users can create new brands, SKUs, and retailers via dialog forms"
    - "Users can edit existing brands, SKUs, and retailers"
    - "Database contains all 5 real brands, ~160 real SKUs, and ~12 real retailers from seed data"
    - "Dashboard home page shows overview stats (brand count, SKU count, retailer count)"
    - "The UI is clean and navigable by non-technical team members"
  artifacts:
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with sidebar navigation"
      contains: "SidebarProvider"
    - path: "src/app/(dashboard)/brands/page.tsx"
      provides: "Brands listing with data table"
      contains: "trpc"
    - path: "src/app/(dashboard)/skus/page.tsx"
      provides: "SKUs listing with filterable data table"
      contains: "trpc"
    - path: "src/app/(dashboard)/retailers/page.tsx"
      provides: "Retailers listing with data table"
      contains: "trpc"
    - path: "src/app/(dashboard)/audit/page.tsx"
      provides: "Audit log viewer"
      contains: "trpc"
    - path: "src/server/db/seed.ts"
      provides: "Seed data for all 5 brands, ~160 SKUs, ~12 retailers"
      contains: "Fomin"
  key_links:
    - from: "src/app/(dashboard)/brands/page.tsx"
      to: "src/server/api/routers/brands.ts"
      via: "trpc.brands.getAll.useQuery()"
      pattern: "trpc\\.brands"
    - from: "src/app/(dashboard)/skus/page.tsx"
      to: "src/server/api/routers/skus.ts"
      via: "trpc.skus.getAll.useQuery()"
      pattern: "trpc\\.skus"
    - from: "src/app/(dashboard)/retailers/page.tsx"
      to: "src/server/api/routers/retailers.ts"
      via: "trpc.retailers.getAll.useQuery()"
      pattern: "trpc\\.retailers"
    - from: "src/components/dashboard/app-sidebar.tsx"
      to: "src/app/(dashboard)/layout.tsx"
      via: "imported and rendered in layout"
      pattern: "AppSidebar"
---

# Plan 01-03: Dashboard UI, Master Data Pages, Seed Data & Audit Viewer

<objective>
Build the complete dashboard UI with sidebar navigation, create master data listing and management pages for brands, SKUs, and retailers (with create/edit dialogs), build the audit log viewer, and seed the database with all real Petra Brands master data.

Purpose: This is the user-facing layer that makes the foundation visible and usable. Non-technical team members need to navigate, view, and manage master data from day one (UX-04, FND-03). The audit log viewer (FND-04) provides transparency into data changes.
Output: A fully functional dashboard with populated master data that team members can immediately use.
</objective>

<execution_context>
@/Users/kaaba/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kaaba/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-master-data/01-RESEARCH.md
@.planning/phases/01-foundation-master-data/01-01-SUMMARY.md
@.planning/phases/01-foundation-master-data/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Dashboard layout with sidebar, user nav, and overview home page</name>
  <files>
    src/app/(dashboard)/layout.tsx
    src/app/(dashboard)/page.tsx
    src/components/dashboard/app-sidebar.tsx
    src/components/dashboard/user-nav.tsx
    src/components/dashboard/stat-card.tsx
    src/app/page.tsx
  </files>
  <action>
  **1. Update root page `src/app/page.tsx`** — redirect to dashboard:

  Replace the default Next.js landing page with a redirect to the dashboard:
  ```tsx
  import { redirect } from "next/navigation";

  export default function Home() {
    redirect("/dashboard");
  }
  ```

  Wait — the (dashboard) route group means the routes inside it don't have `/dashboard` in the URL. The `(dashboard)/page.tsx` maps to `/` because of the route group. So actually, the root `src/app/page.tsx` IS the dashboard home if we use the (dashboard) route group at `/`.

  BUT the middleware redirects unauthenticated users to `/login`. So when an authenticated user hits `/`, they get the dashboard page.

  APPROACH: Delete the default `src/app/page.tsx` content and make `src/app/(dashboard)/page.tsx` serve as the home page at `/`. The (dashboard) route group with its layout will apply to all pages under it.

  Actually, simpler approach: Keep `src/app/page.tsx` as a redirect:
  ```tsx
  import { redirect } from "next/navigation";
  export default function RootPage() {
    redirect("/brands");
  }
  ```
  This sends the user to the brands page as the default landing page after login.

  **2. Create `src/components/dashboard/app-sidebar.tsx`** — sidebar navigation:

  Use shadcn/ui Sidebar components. Import from `@/components/ui/sidebar`.

  Navigation items (with icons from lucide-react):
  - **Dashboard** — icon: `LayoutDashboard` — href: `/`
  - **Brands** — icon: `Tag` — href: `/brands`
  - **SKUs** — icon: `Package` — href: `/skus`
  - **Retailers** — icon: `Store` — href: `/retailers`
  - **Audit Log** — icon: `History` — href: `/audit`

  At the top of the sidebar, show the app name: "Petra Supply Hub" with a subtle logo area.

  At the bottom of the sidebar, show the user section using `UserNav` component (name, role, sign out button).

  Make it a client component (`"use client"`) for active link highlighting using `usePathname()` from `next/navigation`.

  Use these shadcn Sidebar subcomponents:
  - `Sidebar`, `SidebarContent`, `SidebarHeader`, `SidebarFooter`, `SidebarMenu`, `SidebarMenuItem`, `SidebarMenuButton`, `SidebarGroup`, `SidebarGroupLabel`, `SidebarGroupContent`

  Highlight the active link by comparing `pathname` with the href. Use a different background color or bold text for the active item.

  Install lucide-react if not already: `npm install lucide-react`

  **3. Create `src/components/dashboard/user-nav.tsx`** — user info and sign out:

  Client component showing:
  - User avatar (initials from name) using shadcn `Avatar`
  - User name and role badge
  - Sign out button that calls `signOut()` from `next-auth/react`

  Use shadcn `DropdownMenu` for the avatar click:
  ```
  [Avatar with initials]  →  Dropdown:
                               - Name
                               - Role: CEO
                               - ---
                               - Sign Out
  ```

  Get the session using `useSession()` from `next-auth/react`. NOTE: This requires `SessionProvider` in the providers tree. Update `src/components/providers.tsx` to include `SessionProvider` from `next-auth/react` wrapping the children (inside the tRPC + QueryClient providers).

  **4. Create `src/components/dashboard/stat-card.tsx`** — reusable stat card:

  A simple card component showing a title, value, and optional description:
  ```tsx
  interface StatCardProps {
    title: string;
    value: string | number;
    description?: string;
    icon?: React.ReactNode;
  }
  ```

  Use shadcn `Card`, `CardHeader`, `CardTitle`, `CardContent`.

  **5. Create `src/app/(dashboard)/layout.tsx`** — dashboard layout:

  ```tsx
  import { SidebarProvider, SidebarInset, SidebarTrigger } from "@/components/ui/sidebar";
  import { AppSidebar } from "@/components/dashboard/app-sidebar";
  import { Separator } from "@/components/ui/separator";

  export default function DashboardLayout({ children }: { children: React.ReactNode }) {
    return (
      <SidebarProvider>
        <AppSidebar />
        <SidebarInset>
          <header className="flex h-16 shrink-0 items-center gap-2 border-b px-4">
            <SidebarTrigger className="-ml-1" />
            <Separator orientation="vertical" className="mr-2 h-4" />
            <h1 className="text-lg font-semibold">Petra Supply Hub</h1>
          </header>
          <main className="flex-1 overflow-y-auto p-6">
            {children}
          </main>
        </SidebarInset>
      </SidebarProvider>
    );
  }
  ```

  **6. Create `src/app/(dashboard)/page.tsx`** — dashboard home:

  Client component that shows overview statistics:
  - Total Brands (count from `trpc.brands.getAll`)
  - Total SKUs (count from `trpc.skus.getAll`)
  - Total Retailers (count from `trpc.retailers.getAll`)

  Layout: 3 stat cards in a responsive grid (1 col mobile, 3 cols desktop):
  ```
  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
  │   5 Brands  │  │  160 SKUs   │  │ 12 Retailers│
  │   Active    │  │   Active    │  │   Active    │
  └─────────────┘  └─────────────┘  └─────────────┘
  ```

  Below the stats, show a welcome message:
  "Welcome back, {user.name}. Manage your brands, SKUs, and retailers from the sidebar."

  Use Tailwind classes: `grid grid-cols-1 md:grid-cols-3 gap-6`
  </action>
  <verify>
  - `npm run build` succeeds
  - `src/app/(dashboard)/layout.tsx` renders sidebar with navigation
  - `src/components/dashboard/app-sidebar.tsx` has 5 nav items (Dashboard, Brands, SKUs, Retailers, Audit Log)
  - `src/components/dashboard/user-nav.tsx` shows user name and sign out
  - `src/app/(dashboard)/page.tsx` shows 3 stat cards
  - `lucide-react` is installed
  - `SessionProvider` is included in providers
  </verify>
  <done>
  Dashboard layout complete with sidebar navigation (5 items), user nav with sign-out, and home page with overview statistics. UI is clean and professional using shadcn/ui components. UX-04 (clean design for non-technical users) is addressed through the layout.
  </done>
</task>

<task type="auto">
  <name>Task 2: Master data CRUD pages (Brands, SKUs, Retailers) with data tables and form dialogs</name>
  <files>
    src/app/(dashboard)/brands/page.tsx
    src/app/(dashboard)/brands/columns.tsx
    src/app/(dashboard)/skus/page.tsx
    src/app/(dashboard)/skus/columns.tsx
    src/app/(dashboard)/retailers/page.tsx
    src/app/(dashboard)/retailers/columns.tsx
    src/components/dashboard/data-table.tsx
    src/components/dashboard/brand-form-dialog.tsx
    src/components/dashboard/sku-form-dialog.tsx
    src/components/dashboard/retailer-form-dialog.tsx
  </files>
  <action>
  **1. Create `src/components/dashboard/data-table.tsx`** — reusable data table component:

  Build a generic, reusable data table using shadcn/ui `Table` component. This is NOT the @tanstack/react-table based one — keep it simple with a direct mapping approach for Phase 1:

  Actually, use shadcn's DataTable pattern with @tanstack/react-table for sorting and filtering. Install it:
  ```bash
  npm install @tanstack/react-table
  ```

  Create a generic DataTable component:
  ```tsx
  "use client";

  import {
    ColumnDef,
    flexRender,
    getCoreRowModel,
    useReactTable,
    getSortedRowModel,
    SortingState,
    getFilteredRowModel,
    ColumnFiltersState,
  } from "@tanstack/react-table";
  import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "@/components/ui/table";
  import { Input } from "@/components/ui/input";
  import { useState } from "react";

  interface DataTableProps<TData, TValue> {
    columns: ColumnDef<TData, TValue>[];
    data: TData[];
    searchKey?: string;  // Column key to enable search filtering
    searchPlaceholder?: string;
  }
  ```

  Features:
  - Sortable columns (click header to sort)
  - Search/filter input (filters by the `searchKey` column)
  - Responsive: horizontal scroll on mobile
  - Empty state: "No results found." centered in table

  **2. Create Brands page and columns:**

  `src/app/(dashboard)/brands/columns.tsx`:
  Define column definitions for the brands table:
  - Name (sortable)
  - Description (truncated to 50 chars)
  - Lead Time (e.g., "30 days")
  - SKUs (count from the `skus` relation)
  - Status (Badge: green "Active" or gray "Inactive")
  - Actions (DropdownMenu with Edit and Deactivate options)

  `src/app/(dashboard)/brands/page.tsx`:
  Client component that:
  - Fetches brands via `trpc.brands.getAll.useQuery()`
  - Shows page title "Brands" with description "Manage your brand portfolio"
  - Has an "Add Brand" button (opens BrandFormDialog)
  - Renders DataTable with brand columns and data
  - Shows loading skeleton while data loads
  - Shows error toast if fetch fails

  **3. Create Brand form dialog `src/components/dashboard/brand-form-dialog.tsx`:**

  Dialog with form for creating or editing a brand:
  - Props: `{ open: boolean, onOpenChange: (open: boolean) => void, brand?: Brand }` (if brand is provided, it is edit mode)
  - Fields:
    - Name (Input, required, max 255 chars)
    - Description (Input/Textarea, optional)
    - Lead Time Days (Input type="number", required, default 30)
  - Submit calls `trpc.brands.create.useMutation()` or `trpc.brands.update.useMutation()`
  - On success: close dialog, invalidate brands query (via `trpc.useUtils().brands.getAll.invalidate()`)
  - On error: show error message in dialog
  - Use shadcn `Dialog`, `DialogContent`, `DialogHeader`, `DialogTitle`, `DialogDescription`, `DialogFooter`
  - Use shadcn `Label`, `Input`, `Button`

  **4. Create SKUs page and columns:**

  `src/app/(dashboard)/skus/columns.tsx`:
  Column definitions:
  - SKU Code (sortable, monospace font)
  - Name (sortable)
  - Brand (from relation, displayed as badge with brand color)
  - Category
  - Unit Cost (formatted as $X.XX, or "—" if null)
  - Unit Price (formatted as $X.XX, or "—" if null)
  - Status (Badge)
  - Actions (Edit, Deactivate)

  `src/app/(dashboard)/skus/page.tsx`:
  Client component that:
  - Fetches SKUs via `trpc.skus.getAll.useQuery()`
  - Page title "SKUs" with description "Manage product SKUs across all brands"
  - "Add SKU" button (opens SKUFormDialog)
  - Brand filter: dropdown to filter by brand (uses `trpc.brands.getAll` for the options). When a brand is selected, pass `{ brandId }` to the query. The filter should be a Select/DropdownMenu above the table with "All Brands" as the default option.
  - DataTable with search on "name" or "sku" column
  - Loading skeleton while fetching

  **5. Create SKU form dialog `src/components/dashboard/sku-form-dialog.tsx`:**

  Dialog for creating/editing SKU:
  - Fields:
    - Brand (Select dropdown populated from `trpc.brands.getAll`, required)
    - SKU Code (Input, required, unique, max 100 chars)
    - Name (Input, required, max 255 chars)
    - Description (Textarea, optional)
    - Category (Input, optional)
    - Unit Cost (Input type="number" with step="0.01", optional)
    - Unit Price (Input type="number" with step="0.01", optional)
  - Create/Update via tRPC mutation
  - On success: close dialog, invalidate skus query

  **6. Create Retailers page and columns:**

  `src/app/(dashboard)/retailers/columns.tsx`:
  Column definitions:
  - Name (sortable)
  - Code (monospace)
  - Parent Group (e.g., "TJX Companies")
  - Channel (Badge with color: off-price=blue, grocery=green, mass=orange, online=purple)
  - Status (Badge)
  - Actions (Edit, Deactivate)

  `src/app/(dashboard)/retailers/page.tsx`:
  Client component that:
  - Fetches retailers via `trpc.retailers.getAll.useQuery()`
  - Page title "Retailers" with description "Manage retail partners"
  - "Add Retailer" button (opens RetailerFormDialog)
  - DataTable with search on "name"
  - Loading skeleton

  **7. Create Retailer form dialog `src/components/dashboard/retailer-form-dialog.tsx`:**

  Dialog for creating/editing retailer:
  - Fields:
    - Name (Input, required)
    - Code (Input, required, uppercase, e.g., "TJX_MARMAXX")
    - Parent Group (Input, optional)
    - Channel (Select: off-price, grocery, mass, online, club, specialty)
  - Create/Update via tRPC mutation
  - On success: close, invalidate retailers query

  **DESIGN GUIDELINES (UX-04):**
  - Use consistent spacing: `space-y-6` between sections, `gap-4` in grids
  - Page header pattern: `<div className="flex items-center justify-between"><div><h2 className="text-3xl font-bold tracking-tight">{title}</h2><p className="text-muted-foreground">{description}</p></div><Button>{action}</Button></div>`
  - Tables should have zebra striping or hover highlight (Tailwind `hover:bg-muted/50`)
  - All monetary values formatted with $ and 2 decimal places
  - All dates formatted as readable strings (e.g., "Jan 15, 2026")
  - Loading states use shadcn `Skeleton` components
  - Empty states show a friendly message with an action button
  - Form validation: inline error messages below each field
  - Dialogs close on successful submission with a success toast via sonner
  - All buttons have clear labels (not just icons)
  </action>
  <verify>
  - `npm run build` succeeds
  - `/brands` page renders a data table with Add Brand button
  - `/skus` page renders a data table with brand filter and Add SKU button
  - `/retailers` page renders a data table with Add Retailer button
  - All three pages use the reusable DataTable component
  - Form dialogs open for create (empty form) and edit (pre-filled form)
  - Mutations call tRPC endpoints and invalidate queries on success
  - All pages have loading states and empty states
  - @tanstack/react-table is installed
  </verify>
  <done>
  Three master data management pages (Brands, SKUs, Retailers) with data tables, search/filter, and CRUD dialogs. All pages use consistent design patterns, shadcn/ui components, and tRPC for data fetching/mutation. FND-03 (master data management) is addressed with full CRUD UI.
  </done>
</task>

<task type="auto">
  <name>Task 3: Audit log viewer, complete seed data, and final verification</name>
  <files>
    src/app/(dashboard)/audit/page.tsx
    src/server/db/seed.ts
  </files>
  <action>
  **1. Create `src/app/(dashboard)/audit/page.tsx`** — audit log viewer:

  Client component that:
  - Fetches recent audit entries via `trpc.audit.getRecent.useQuery({ limit: 50 })`
  - Page title "Audit Log" with description "Track all data changes across the system"
  - Filter by table name: dropdown with options (All, brands, skus, retailers, purchase_orders, forecasts, inventory, retail_orders, payments)
  - Displays audit entries in a table with columns:
    - Timestamp (formatted as "Feb 6, 2026 3:45 PM")
    - Table (badge with table name)
    - Action (colored badge: INSERT=green, UPDATE=blue, DELETE=red)
    - Record ID
    - Changes (expandable — show a summary like "name: Fomin -> Fomin Towels", parse the JSON changedData and previousData to show diffs)
  - For the "Changes" column, create a simple diff display:
    - For INSERT: show key fields from changedData (e.g., "Created: name=Fomin, leadTimeDays=30")
    - For UPDATE: compare changedData and previousData, show only fields that changed (e.g., "name: Fomin -> Fomin Towels")
    - For DELETE: show "Deleted: name=Fomin"
  - Pagination: "Load More" button at the bottom (increase limit by 50)
  - If no entries, show "No audit entries yet. Changes to data will appear here."

  **2. Update `src/server/db/seed.ts`** — comprehensive seed with all real Petra Brands data:

  Replace the previous minimal seed with a comprehensive one that loads ALL real master data.

  ```typescript
  // BRANDS — all 5 Petra Brands
  const brandsData = [
    { name: "Fomin", description: "Clean towels — natural, body, exfoliating, gym, hair, cotton pads", leadTimeDays: 30 },
    { name: "Luna Naturals", description: "Mosquito repellent — wipes, roll-ons, bracelets, sprays, balms, candles, sticks. Seasonal (peaks summer)", leadTimeDays: 30 },
    { name: "EveryMood", description: "Hand sanitizer mists, body oils, bath & hair mists. New brand (shipping since Nov 2025)", leadTimeDays: 30 },
    { name: "Roofus", description: "Pet products — bath, wipes, shampoo, paw cleaner, dental kits, poop bags. Growing brand", leadTimeDays: 30 },
    { name: "House of Party", description: "Craft kits — PixelPop, Muddies, Threadies. Multiple suppliers (Butterfly, Homecrest, KKV)", leadTimeDays: 60 },
  ];
  ```

  For SKUs, create representative SKUs for each brand. We don't have the exact 160 SKUs from the Google Sheet, so create realistic placeholders that can be replaced later when the CSV import is built:

  **Fomin (12 SKUs):**
  - FOM-NT-001: Natural Clean Towels 20ct
  - FOM-NT-002: Natural Clean Towels 40ct
  - FOM-BT-001: Body Clean Towels 20ct
  - FOM-BT-002: Body Clean Towels 40ct
  - FOM-EX-001: Exfoliating Towels 15ct
  - FOM-EX-002: Exfoliating Towels 30ct
  - FOM-GY-001: Gym Towels 20ct
  - FOM-GY-002: Gym Towels 40ct
  - FOM-HT-001: Hair Towels 10ct
  - FOM-HT-002: Hair Towels 20ct
  - FOM-CP-001: Cotton Pads 60ct
  - FOM-CP-002: Cotton Pads 100ct

  **Luna Naturals (16 SKUs):**
  - LUN-WP-001: Mosquito Repellent Wipes 15ct
  - LUN-WP-002: Mosquito Repellent Wipes 30ct
  - LUN-RO-001: Repellent Roll-On 2oz
  - LUN-RO-002: Repellent Roll-On 4oz
  - LUN-BR-001: Repellent Bracelet Single
  - LUN-BR-002: Repellent Bracelet 3-Pack
  - LUN-SP-001: Repellent Spray 4oz
  - LUN-SP-002: Repellent Spray 8oz
  - LUN-BM-001: After-Bite Balm 1oz
  - LUN-BM-002: After-Bite Balm 2oz
  - LUN-CN-001: Citronella Candle Small
  - LUN-CN-002: Citronella Candle Large
  - LUN-ST-001: Repellent Stick Single
  - LUN-ST-002: Repellent Stick 3-Pack
  - LUN-KT-001: Family Protection Kit
  - LUN-KT-002: Travel Protection Kit

  **EveryMood (34 SKUs):** Create 34 SKUs across categories:
  - Hand Sanitizer Mists (8 scents/sizes): EMD-HS-001 through EMD-HS-008
  - Body Oils (8 scents/sizes): EMD-BO-001 through EMD-BO-008
  - Bath Mists (8 scents/sizes): EMD-BM-001 through EMD-BM-008
  - Hair Mists (6 scents/sizes): EMD-HM-001 through EMD-HM-006
  - Gift Sets (4 variants): EMD-GS-001 through EMD-GS-004

  Give each a descriptive name like "Lavender Hand Sanitizer Mist 2oz", "Rose Gold Body Oil 4oz", etc.

  **Roofus (21 SKUs):** Create 21 SKUs:
  - Pet Bath (4): ROO-PB-001 through ROO-PB-004 (different sizes/types)
  - Pet Wipes (4): ROO-PW-001 through ROO-PW-004
  - Pet Shampoo (4): ROO-PS-001 through ROO-PS-004
  - Paw Cleaner (3): ROO-PC-001 through ROO-PC-003
  - Dental Kits (3): ROO-DK-001 through ROO-DK-003
  - Poop Bags (3): ROO-PP-001 through ROO-PP-003

  **House of Party (~75 SKUs):** Create 75 SKUs across craft kit lines:
  - PixelPop (25): HOP-PP-001 through HOP-PP-025 (various designs/themes)
  - Muddies (25): HOP-MD-001 through HOP-MD-025 (various designs/themes)
  - Threadies (25): HOP-TH-001 through HOP-TH-025 (various designs/themes)

  Give each a descriptive name. For HOP, use names like "PixelPop Unicorn Kit", "Muddies Space Explorer Set", "Threadies Friendship Bracelet Kit".

  **RETAILERS (12+):**
  ```typescript
  const retailersData = [
    { name: "MarMaxx (TJ Maxx/Marshalls)", code: "TJX_MARMAXX", parentGroup: "TJX Companies", channel: "off-price" },
    { name: "HomeGoods", code: "TJX_HOMEGOODS", parentGroup: "TJX Companies", channel: "off-price" },
    { name: "Sierra", code: "TJX_SIERRA", parentGroup: "TJX Companies", channel: "off-price" },
    { name: "TJX Canada (Winners/HomeSense)", code: "TJX_CANADA", parentGroup: "TJX Companies", channel: "off-price" },
    { name: "TJX EU/AU (TK Maxx)", code: "TJX_INTL", parentGroup: "TJX Companies", channel: "off-price" },
    { name: "Five Below", code: "FIVE_BELOW", parentGroup: null, channel: "mass" },
    { name: "Ollie's Bargain Outlet", code: "OLLIES", parentGroup: null, channel: "off-price" },
    { name: "Ross Dress for Less", code: "ROSS", parentGroup: null, channel: "off-price" },
    { name: "Burlington", code: "BURLINGTON", parentGroup: null, channel: "off-price" },
    { name: "Bealls", code: "BEALLS", parentGroup: null, channel: "off-price" },
    { name: "Kroger", code: "KROGER", parentGroup: null, channel: "grocery" },
    { name: "Walmart Canada", code: "WALMART_CA", parentGroup: "Walmart", channel: "mass" },
    { name: "CVS", code: "CVS", parentGroup: null, channel: "pharmacy" },
    { name: "Target Online", code: "TARGET_ONLINE", parentGroup: "Target", channel: "online" },
    { name: "Whole Foods", code: "WHOLE_FOODS", parentGroup: "Amazon", channel: "grocery" },
    { name: "Barnes & Noble", code: "BARNES_NOBLE", parentGroup: null, channel: "specialty" },
  ];
  ```

  **BRAND-RETAILER mappings:** After inserting brands and retailers, insert brand_retailers entries:
  - Fomin: TJX_MARMAXX, TJX_HOMEGOODS, TJX_SIERRA, TJX_CANADA, TJX_INTL, KROGER
  - Luna Naturals: TJX_MARMAXX, TJX_HOMEGOODS, TARGET_ONLINE, WHOLE_FOODS, ROSS, BURLINGTON, BEALLS
  - EveryMood: TJX_MARMAXX, FIVE_BELOW, OLLIES, ROSS, BURLINGTON, BEALLS
  - Roofus: TJX_MARMAXX, FIVE_BELOW, BURLINGTON, ROSS, BEALLS
  - House of Party: BARNES_NOBLE, TJX_MARMAXX, BEALLS

  **ADDITIONAL USERS for testing:**
  ```typescript
  const usersData = [
    { name: "Kaaba", email: "kaaba@petrograms.com", role: "ceo", password: "admin123" },
    { name: "Sales User", email: "sales@petrograms.com", role: "sales", password: "sales123" },
    { name: "Purchasing User", email: "purchasing@petrograms.com", role: "purchasing", password: "purchasing123" },
    { name: "Warehouse User", email: "warehouse@petrograms.com", role: "warehouse", password: "warehouse123" },
  ];
  ```

  The seed script should:
  1. Check if data already exists (idempotent — skip if brands already populated)
  2. Insert users with hashed passwords
  3. Insert brands
  4. Insert retailers
  5. Insert SKUs (referencing brand IDs from step 3)
  6. Insert brand_retailers (referencing brand and retailer IDs)
  7. Run audit trigger SQL
  8. Log summary: "Seeded: X brands, Y SKUs, Z retailers, W users"

  Use transactions where possible for consistency. Use `db.insert(...).values([...]).onConflictDoNothing()` for idempotency where unique constraints exist.

  **3. Verify the full flow works end-to-end:**

  After seeding, the expected state is:
  - 4 users (CEO, sales, purchasing, warehouse)
  - 5 brands
  - ~158 SKUs (12 + 16 + 34 + 21 + 75)
  - 16 retailers
  - Brand-retailer mappings
  - Audit triggers active on all tables
  </action>
  <verify>
  - `npm run build` succeeds
  - `/audit` page renders audit log with filter by table and expandable changes
  - `src/server/db/seed.ts` inserts 5 brands, ~158 SKUs, 16 retailers, 4 users, brand-retailer mappings
  - Seed script is idempotent (running twice doesn't create duplicates)
  - After seeding, `/brands` shows 5 brands, `/skus` shows ~158 SKUs, `/retailers` shows 16 retailers
  - After seeding, audit log shows INSERT entries for all seeded data (from triggers)
  - Dashboard home shows correct counts in stat cards
  - All pages navigate correctly from sidebar
  </verify>
  <done>
  Audit log viewer at /audit shows all data changes with table filter, action badges, and expandable change diffs. Database seeded with all 5 Petra brands, ~158 representative SKUs, 16 retailers, 4 role-based users, and brand-retailer mappings. Full dashboard is functional with navigation, data tables, CRUD dialogs, and audit trail. All Phase 1 success criteria are met:
  1. Database schema supports all required entities (FND-01)
  2. Users can log in with roles and access dashboard (FND-02)
  3. Master data tables contain canonical reference data (FND-03)
  4. Audit log captures and displays all changes (FND-04)
  5. Dashboard UI is clean and navigable (UX-04)
  </done>
</task>

</tasks>

<verification>
- [ ] Dashboard layout renders with sidebar (5 navigation items) and header
- [ ] Sidebar highlights active page
- [ ] User nav shows name, role, and sign out
- [ ] Dashboard home shows 3 stat cards with correct counts
- [ ] Brands page shows data table with 5 brands, sortable, searchable
- [ ] SKUs page shows data table with ~158 SKUs, filterable by brand
- [ ] Retailers page shows data table with 16 retailers, searchable
- [ ] Brand form dialog creates new brand and refreshes table
- [ ] SKU form dialog creates new SKU (with brand selection) and refreshes table
- [ ] Retailer form dialog creates new retailer and refreshes table
- [ ] Edit works for brands, SKUs, and retailers (pre-fills form)
- [ ] Deactivate works (soft delete, item disappears from active list)
- [ ] Audit log page shows recent changes with table filter
- [ ] Audit log shows correct actions (INSERT/UPDATE/DELETE) with timestamps
- [ ] Change details are parseable (show what changed)
- [ ] `npm run db:seed` populates all master data
- [ ] Running seed twice doesn't create duplicates
- [ ] `npm run build` succeeds with no errors
- [ ] All 4 test users can log in with their credentials
</verification>

<success_criteria>
- Dashboard UI is clean, professional, and navigable by non-technical users (UX-04)
- All master data (5 brands, ~158 SKUs, 16 retailers) is visible and manageable (FND-03)
- CRUD operations work for all master data types with form validation
- Audit log captures and displays all data changes (FND-04)
- Brand filter on SKUs page allows filtering by brand
- Multiple user roles can log in and access the dashboard (FND-02)
- All Phase 1 success criteria from the roadmap are met
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-master-data/01-03-SUMMARY.md`
</output>
